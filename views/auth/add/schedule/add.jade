extends ../../../layout

block content_style
	link(rel='stylesheet', type='text/css', href='/styles/add.css')

block content_scripts
	script(type='text/javascript', src='/scripts/add.js')

block content_right
	.navigator
		.nav_title РАСПИСАНИЕ
		br
		b январь
		br
		b февраль
		br
		b март

mixin scheduleMonths(title, numb)
	- var month = true
	each date in schedule
		if (date.date.getMonth() + 1 == numb)
			if (month)
				.form_section= title
				- month = false
			- var d = date.date.getDate()
			- var m = date.date.getMonth()+1
			if (d < 10)
				- d = '0' + d
			if (m < 10)
				- m = '0' + m
			.schedule_item
				a(href='#') удалить
				!=' | '
				a.schedule_date(href= year + '/' + date._id)= d + '.' + m
				!=' | '
				- var banner = 0
				- var premiere = 0
				each event in date.events
					if (event.premiere == 'true')
						- premiere++
					if (event.banner == 'true')
						- banner++
				b= 'банеров: ' + banner
				!=' | '
				b= 'премьер: ' + premiere
				br
				br

block content
	.form_block
		a.back_link(href='/auth') < Назад
		.title РАСПИСАНИЕ НА #{year} ГОД
		.form_section Добавить дату
		form(action="/auth/add/schedule/" + year, method="post", enctype="multipart/form-data")
			.cal_block
				select(name='schedule[date]')
					option(value='') Дата
					- for (var i=1; i<32; i++)
						option(value=i)= i
				select(name='schedule[month]')
					option(value='') Месяц
					- var months = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];
					each month, i in months
						option(value=i)= month
				input(type='hidden', name='schedule[year]', value=year)
				input(type='submit', value='Добавить')
			//- .form_section Расписание
			if (schedule)
				+scheduleMonths('Январь', 1)
				+scheduleMonths('Февраль', 2)
				+scheduleMonths('Март', 3)
				+scheduleMonths('Апрель', 4)
				+scheduleMonths('Май', 5)
				+scheduleMonths('Июнь', 6)
				+scheduleMonths('Июль', 7)
				+scheduleMonths('Август', 8)
				+scheduleMonths('Сентябрь', 9)
				+scheduleMonths('Октябрь', 10)
				+scheduleMonths('Ноябрь', 11)
				+scheduleMonths('Декабрь', 12)